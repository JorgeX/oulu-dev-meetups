---
import Footer from '../../components/Footer.astro';
import Header from '../../components/Header.astro';
import { SITE_TITLE, SITE_DESCRIPTION } from '../../consts';
import BaseHead from '../../components/BaseHead.astro';
import { getCollection } from 'astro:content';
import MeetupListItem from '../../components/MeetupListItem.astro';
import { getMeetupsCollectionName } from '../../content/config';
import { parseMeetupDate } from '../../utils';

const collectionName = getMeetupsCollectionName();
const meetups: any = await getCollection(collectionName);
meetups.sort((a: any, b: any) => {
  return parseMeetupDate(b.data.date) - parseMeetupDate(a.data.date);
});
---

<head>
  <BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
</head>
<body class="h-full">
  <div class="min-h-full">
    <Header />
    <div class="py-4">
      <main>
        <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
          <div
            class="mx-auto max-w-4xl rounded-xl border border-gray-400 bg-gray-50 p-8 sm:px-24"
          >
            <section>
              <ul role="list" class="divide-y divide-gray-100">
                {
                  meetups.map((meetup: any) => (
                    <MeetupListItem
                      name={meetup.data.title}
                      location={meetup.data.location}
                      time={meetup.data.date}
                      organizer={meetup.data.organizer}
                      slug={meetup.slug}
                    />
                  ))
                }
              </ul>
            </section>
          </div>
        </div>
      </main>
      <Footer />
    </div>
  </div>
</body>
