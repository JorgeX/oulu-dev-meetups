name: New event

permissions:
    contents: write
    pull-requests: write

on:
    issues:
        types: [opened]

jobs:
    new-event:
        runs-on: ubuntu-latest

        steps:
            - name: Checkout
              uses: actions/checkout@v3

            - name: Parse issue body
              uses: stefanbuck/github-issue-parser@v3
              id: issue-parser
              with:
                  template-path: .github/ISSUE_TEMPLATE/new-event.yml

            - name: Create new event file
              run: |
                  cat <<EOF > new_event.md

                  ---
                  date: ${{ steps.issue-parser.outputs.issueparser_date }}
                  location: ${{ steps.issue-parser.outputs.issueparser_location }}
                  location_google_maps: ${{ steps.issue-parser.outputs.issueparser_location_google_maps }}
                  organiser: ${{ steps.issue-parser.outputs.issueparser_organiser }}
                  organiser_link: ${{ steps.issue-parser.outputs.issueparser_organiser_link }} 
                  joining_link: ${{ steps.issue-parser.outputs.issueparser_joining_link }}
                  ---

                  ${{ steps.issue-parser.outputs.issueparser_description }}
                  EOF

            - name: Create pull request
              uses: peter-evans/create-pull-request@v5
